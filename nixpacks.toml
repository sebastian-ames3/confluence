# Nixpacks configuration for Railway deployment
# Force Python by installing it directly via Nix packages
# (providers=["python"] didn't work - package.json still caused Node.js detection)

[phases.setup]
nixPkgs = ["python311", "python311Packages.pip", "ffmpeg", "chromium", "chromedriver"]

[phases.install]
# Use pip command directly (not python -m pip) since that's how nix installs it
cmds = ["pip install -r requirements.txt"]

[start]
cmd = "python3.11 scripts/run_migrations.py --auto && python3.11 -m uvicorn backend.app:app --host 0.0.0.0 --port $PORT"
