# PRD-008: Confluence Scorer Agent

**Version**: 1.0  
**Date**: 2025-11-18  
**Phase**: 3 - Confluence Engine  
**Duration**: 3 days  
**Status**: Not Started  
**Dependencies**: PRD-005, PRD-006, PRD-007

---

## Objective

Score analyzed content against Sebastian's 7-pillar investment framework.

---

## Success Criteria

- [ ] Scores all 7 pillars (0-2 each)
- [ ] Generates clear reasoning
- [ ] Defines falsification criteria
- [ ] Sebastian validates 30 scores with >90% agreement
- [ ] <5 seconds per score

---

## Scoring Rubric

### Core 5 Pillars (0-2 each)
1. **Macro data & regime**: Growth/inflation/policy/liquidity evidence
2. **Fundamentals**: Sector/company cash flow impact
3. **Valuation & capital cycle**: What's priced in, supply response
4. **Positioning/flows**: How others are positioned, forced buying/selling
5. **Policy/narrative**: Regulatory alignment, political priorities

### Hybrid 2 Pillars (0-2 each)
6. **Price action**: Technical structure, trend, key levels
7. **Options/volatility**: Vol surface, skew, term structure opportunities

### Thresholds
- **Strong Confluence**: Core â‰¥6-7/10 AND at least one hybrid pillar = 2/2
- **Medium**: Core 4-5/10 OR hybrid pillars weak
- **Weak**: Core <4/10

---

## Agent Specification

### Input
```python
{
    "analyzed_content_id": 123,
    "analysis_data": {
        "key_themes": [...],
        "tickers": [...],
        "sentiment": "bullish",
        "conviction": 8,
        ...
    }
}
```

### Output
```python
{
    "pillar_scores": {
        "macro": 2,
        "fundamentals": 1,
        "valuation": 2,
        "positioning": 1,
        "policy": 2,
        "price_action": 2,
        "options_vol": 1
    },
    "core_total": 8,
    "total_score": 11,
    "meets_threshold": True,
    "reasoning": {
        "macro": "Multiple PMI indicators showing...",
        "fundamentals": "Cash flow evidence limited to...",
        ...
    },
    "falsification_criteria": [
        "If CPI >0.5% MoM for 2 consecutive months",
        "If SPY breaks 5800 support on volume"
    ],
    "variant_view": "Market expects soft landing, we see re-acceleration risk",
    "p_and_l_mechanism": "Long tech LEAPs, short TLT calls"
}
```

---

## Implementation

Uses Claude with specialized prompt based on Sebastian's confluence framework.

---

## Tasks

### Task 8.1: Build Scoring Prompt (4 hours)
### Task 8.2: Implement Agent (4 hours)
### Task 8.3: Reasoning Generation (3 hours)
### Task 8.4: Validation with Sebastian (4 hours)
### Task 8.5: Tests (3 hours)

---

## Deliverables

1. `agents/confluence_scorer.py`
2. Validation results from Sebastian
3. Tests

---

**Status**: Ready after Phase 2 agents complete
